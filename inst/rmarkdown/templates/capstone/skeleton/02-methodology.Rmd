# Methodology {#methodology .unnumbered}

The methodology section may include the following subsections:


## Data {#methodology-data .unnumbered}

General description of the data and source(s). This includes limitations and delimitations; units of analysis; time window for aggregation and modeling (if applicable); and validation and development samples.


## Descriptive analyses {#methodology-descriptive .unnumbered} 

Identification of the methodologies that would provide a view into the data. These may include highlighting the relationships that are important for the research, validating assumptions with respect to important metrics, and providing evidence that substantiates the way data is analyzed.


## Modeling Framework {#methodology-modeling .unnumbered}

Justification of model(s) selected. Identification of dependent and independent variables (whenever applicable), per model if applicable. Variable transformations (if applicable). Future extraction (if applicable). Discussion of model(s) functional form. Assumptions of model(s) and ways of insuring that assumptions are observed or tested. Assessing model(s) performance and validation.

\newpage 

### Code chunks {.unnumbered}

When you click the **Knit** button above a document will be generated that includes both content as well as the output of any embedded code chunks within the document. You can embed a code chunk like this (`sleep` is a built-in **R** dataset. Student (1908) _The probable error of the mean_. Biometrika, 6, 20).

```{r cars-summary}
data(sleep)
summary(sleep)
```

However, one is not restricted to R and R Markdown supports the following languages:

```{r languages}
names(knitr::knit_engines$get())
```

Of these, if you _must_ use `python`, you can do that too!
First load reticulate and then find what path your python resides on.

```{r load-recticulate, eval=FALSE}
library(reticulate)
pyPath <- py_discover_config()
pyPath 
```

Pass the relevant path to the `use_python` function.

```{r python-setup, eval=FALSE}
use_python(pyPath$python_versions[1])
```

Before we install some packages, we need to create a `conda` environment to store them in.
```{r python-conda, eval=FALSE}
# create a new environment 
conda_create("r-reticulate")
```

Install  packages:

```{r python-install, eval=FALSE}
py_install("numpy")
```

Import packages:

```{r r-python-import, eval=FALSE}
numpy <- import("numpy")
```

```{python python-import, eval=FALSE}
import numpy as np
print(np.reshape(np.arange(1,25), (4,3,2), "F"))
```

See the [Reticulate: R interface to Python](https://rstudio.github.io/reticulate/) for more specifics.

Or you can use C++. Rcpp enables compilation of C++ into R functions.

```{Rcpp Rcpp-function, eval=FALSE}
#include <Rcpp.h>
using namespace Rcpp;

// [[Rcpp::export]]
NumericVector humanPercent(NumericVector x) {
  return x * 100;
}
```

Now, `humanPercent` is available to call from R.

```{r r-Rcpp, eval=FALSE}
humanPercent(x=0.0274)
```

Please see [Rcpp for Seamless R and C++ Integration](http://www.rcpp.org/), which provides many examples. 


### Inline code {.unnumbered}

If you'd like to put the results of your analysis directly into your discussion, add inline code like this:

> The `cos` of $2 \pi$ is "r cos(2*pi)". To execute, replace quotes with backticks (`).

> The `cos` of $2 \pi$ is `r cos(2*pi)`. 

Another example would be the direct calculation of the standard deviation:

> The standard deviation of `speed` in `cars` is "r sd(cars$speed)".

> The standard deviation of `speed` in `cars` is `r sd(cars$speed)`.

One last neat feature is the use of the `ifelse` conditional statement which can be used to output text depending on the result of an **R** calculation:

> r ifelse(sd(cars$speed) < 6, "The standard deviation is less than 6.", "The standard deviation is equal to or greater than 6.")

> `r ifelse(sd(cars$speed) < 6, "The standard deviation is less than 6.", "The standard deviation is equal to or greater than 6.")`

Note the use of `>` here, which signifies a quotation environment that will be indented.

As you see with `$2 \pi$` above, mathematics can be added by surrounding the mathematical text with dollar signs.  More examples of this are in [Mathematics and Science] if you uncomment the code in [Math].  

### Including plots {.unnumbered}

You can also embed plots.  For example, here is a way to use the base **R** graphics package to produce a plot using the built-in `pressure` dataset:

```{r pressure, echo=FALSE}
plot(pressure, type = "l", col="cornflowerblue", lwd = 2,
               xlab = "Temperature (deg C)",
               ylab = "Pressure (mm of Hg)",
               main = "pressure data: Vapor Pressure of Mercury",
               frame = FALSE)
```

Note that the `echo=FALSE` parameter was added to the code chunk to prevent printing of the **R** code that generated the plot. However, we also labeled the code chunk `pressure` so we can call its contents and print them in the Appendex.  There are plenty of other ways to add chunk options.  More information is available at <http://yihui.name/knitr/options/>.  


### Loading and exploring data {.unnumbered}

From the description file (`?ToothGrowth`): 

>The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC).

Variables:

 - *len*:	_numeric_.	Tooth length
 -	*supp*:	_factor_.	Supplement type (VC or OJ).
 - *dose*:	_numeric_.	Dose in milligrams/day


First load some data, clean up the variable names, and do some exploratory data analysis through the use of plots and tables. Also, transform `dose` into a `factor` as there exists only three dosage levels.


```{r toothGrowth-data}
data(ToothGrowth)
colnames(ToothGrowth) <- c("length", "supplement", "dose")
ToothGrowth$dose <- as.factor(ToothGrowth$dose)
```

Use the `kable` function to create convenient, decent looking tables. Another package which creates higher quality tables is the venerable [xtable](https://cran.r-project.org/web/packages/xtable/index.html) package, which is highly recommended for \LaTeX\ PDFs.

```{r toothGrowth-table}
library(knitr)
kable(head(ToothGrowth, 5), align = "r")

kable(tail(ToothGrowth, 5), align = "r")
```

\newpage 

The `aggregate` function can be used to compute the mean tooth `length` by`supplement` and `dose`. 

```{r groupedTooth, warning=FALSE}
groupedTooth <- aggregate(ToothGrowth, by=ToothGrowth[,2:3], FUN=mean)[,1:3]

kable(groupedTooth, align = "r")
```                   

### Additional R Markdown resources {.unnumbered}

- _Markdown_ Info Sheet - <https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet>

- _R Markdown_ Reference Guide - <https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf>

\newpage

## Math and Science notation  {#math-sci .unnumbered}
<!-- Required to number equations in HTML files -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

\TeX\ is the best way to typeset mathematics. Donald Knuth designed \TeX\ when he got frustrated at how long it was taking the typesetters to finish his book, which contained a lot of mathematics.  One nice feature of _R Markdown_ is its ability to read \LaTeX\ code directly.

Get around math mode's automatic italicizing in LaTeX by using the argument `$\mathrm{formula here}$`, with your formula inside the curly brackets.  (Notice the use of the backticks here which enclose text that acts as code.)

So, $\mathrm{Fe_2^{2+}Cr_2O_4}$ is written `$\mathrm{Fe_2^{2+}Cr_2O_4}$`.

The \noindent command below does what you'd expect:  it forces the current line/paragraph to not indent. See below and examples of commonly used symbols:

\noindent Exponent or Superscript written as `$x^2$` becomes $x^2$

\noindent Subscript written as `$x_1$` becomes $x_1$

\noindent Infinity written as `$\infty$` becomes $\infty$

\noindent alpha written as `$\alpha$` becomes $\alpha$

\noindent beta written as `$\beta$` becomes $\beta$

\noindent delta written as `$\delta$` becomes $\delta$

\noindent epsilon written as `$\epsilon$` becomes $\epsilon$

\noindent sigma written `$\sum_{i=1}^n f(x)$` becomes $\sum_{i=1}^n f(x)$

### Math Examples {.unnumbered}

An Ordinary Least Squares model, from _Introductory Econometrics, 6th edition_ by Jeffrey M. Wooldridge, page 27. 

$$y_i = \beta_0 + \beta_1 x_i + \epsilon_i$$ 

An infinite distributed lag (IDL) time series model, by Wooldridge, page 633.

$$ y_t = \alpha + \delta_0 z_t + \delta_1 z_{t-1} + \delta_2 z_{t-2} \ldots + \epsilon_t$$ 

A vector autoregressive (VAR) model, by Wooldridge, page 657. 

$$ y_t = \delta_0 + \alpha_1 y_{t-1} + \gamma_1 z_{t-1} + \alpha_2 y_{t-2} + \gamma_2 z_{t-2} \ldots,$$ 
\newpage

Determinant of a square matrix: 


$$\det\left|\,\begin{matrix}%
c_0&c_1\hfill&c_2\hfill&\ldots&c_n\hfill\cr
c_1&c_2\hfill&c_3\hfill&\ldots&c_{n+1}\hfill\cr
c_2&c_3\hfill&c_4\hfill&\ldots&c_{n+2}\hfill\cr
\,\vdots\hfill&\,\vdots\hfill&
  \,\vdots\hfill&&\,\vdots\hfill\cr
c_n&c_{n+1}\hfill&c_{n+2}\hfill&\ldots&c_{2n}\hfill\cr
\end{matrix}\right|>0$$ 

\bigskip

A regularization problem solved by Jerome Friedman, Trevor Hastie, Rob Tibshirani and Noah Simon, implemented in the [R package `glmnet`](https://cran.r-project.org/web/packages/glmnet/index.html). 


$$ \min_{\beta_0,\beta} \frac{1}{N}\sum_{i=1}^N w_il(y_i,\beta_0+\beta^Tx_i)+\lambda \left[(1-\alpha) ||\beta||_2^2/2+\alpha||\beta||_1\right]$$ 

\bigskip

From Lapidus and Pindar, Numerical Solution of Partial Differential Equations in Science and Engineering, page 54. 

$$\int_t\left\{\sum_{j=1}^3 T_j \left({d\phi_j\over dt}+k\phi_j\right)-kT_e\right\}w_i(t)\ dt=0, \qquad\quad i=1,2,3.$$ 

\bigskip
  
From Lapidus and Pindar, page 145. 

$$\int_{-1}^1\!\int_{-1}^1\!\int_{-1}^1 f\big(\xi,\eta,\zeta\big) = \sum_{k=1}^n\sum_{j=1}^n\sum_{i=1}^n w_i w_j w_k f\big( \xi,\eta,\zeta\big).$$ 


